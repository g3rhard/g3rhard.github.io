---
layout: post
title:  "Шаблон Postmortem для инциндентов"
date:   2019-09-09 09:00:00 +0800
categories: translate
---

Перевод статьи [Our incident postmortem template](https://www.hostedgraphite.com/blog/incident-postmortem-template)

*Примечание: Это вольный и дословный перевод указанной статьи выше, который будет написан от лица авторов*

Эта статья - заключительная в цикле статей про процессы в работе SRE, в которой авторы публикуют свой шаблон Postmortem с некоторыми моментами, на которые стоит обратить внимание, что можно включить в каждую секцию, плюс примеры лучших практик. Этот шаблон следует принципам, уже описанным в [недавнем руководстве по написанию postmortem](https://www.hostedgraphite.com/blog/its-dead-jim-how-we-write-an-incident-postmortem) и является тем, что нужно держать в уме, прежде чем начать писать. Если вы его не читали - убедитесь, что сделали это сначала.

## Написание как двухступенчатый процесс

В [Hosted Graphite](https://www.hostedgraphite.com/) пользователи хорошо технически подкованы и ценят детали событий. Поэтому, для публичных документов мы прилагаем значительные усилия, что бы выбрать правильный язык и уровень детализации для событий. Это значит, что сначала акцент должен быть на как можно более полном и точном сборе информации, а уже после этого перевести текст в более понятный.
Имея это ввиду, при написании вашего первого черновика (шаг 1) postmortem, вы должны сфокусироваться на сборе информации, которую хотите включить и проверить ее точность. Этот черновик должен отражать: что случилось, объяснения почему, включить все уроки, которые вы (коллективно) вынесли из этого инциндента. Когда у вас будет положительный отклик на этот черновик - самое время (шаг 2) поработать над языком и тоном этого документа, для того, что бы сделать его достоянием общественности (конечно, если ваша цель - внешняя публикация документа). Это позволит сосредоточиться на правильной подаче информации и разделить проблемы, сфокусировав обзор так, что бы разные проблемы имели разный язык и тон.

## Рецензирование документа

В идеальном случае, ваш черновик должны рецензировать все SRE, задействованные в процессе решения инциндента, кто сделал свой вклад, и кто вынес для себя уроки. Как минимум двое SRE должны подписать черновик, прежде чем переходить к шагу два, что также потребует как минимум двоих SRE, прежде чем документ будет готов для публикации.

Если ваш postmortem был рецензирован (если это публичный документ), вы можете скопировать его на свою страницу [Statuspage](https://status.hostedgraphite.com/). Держите в уме, что форматирование документа также имеет большое значение, поэтому перед публикацией необходимо проверить, как будет выглядеть документ.

Обязательно убедитесь, что поделились этим документом с остальной (незадействованной в инцинденте) частью команды SRE. То, что вы пишете postmortem будет полезно только в том случае, если все в вашей команде смогут прочитать его, поэтому попросите всех уделить время для его прочтения и, по возможности, отправить обратный отклик.

## Секции

Это [простой шаблон](https://gist.github.com/g3rhard/743f4821589972706ef5bb9c67b242bd) с помощью которого можно сфокусироваться на процессах и содержании больше, чем на структуре самого документа. Ниже будет приведено краткое объяснение каждой секции и некоторые советы касательно написания и примеры того, что нужно в него включить.

### "Краткое описание"

Это просто краткое описание инциндента: что случилось и (что) какие сервисы были затронуты. Обычно это описание занимает не больше одного-двух предложений. После прочтения этого описания, лицо, незнакомое с инциндентом, должно понять, в чем проблема и почему он должен прочесть этот документ целиком.

### "Background"

Помните: Postmortem - это технический документ и иногда его читают те, кто не до конца может его понять. Иногда даже технически подкованная аудитория может иметь проблемы с его пониманием, если будет утерян важный контекст. В этой секции постарайтесь добавить важных деталей, которые нужны для полного понимания всего документа. Для примера, в Postmortem могут быть ссылки на внутренние документы, поэтому имеет смысл кратко объяснить, как они могут быть полезны (и заработать бонусные баллы себе, оставив ссылку на наш блог).

Когда это возможно, не забывайте добавлять ссылки на публичную документацию и/или записи блогов. Если вы поймете, что объясняете какой-то момент снова и снова - возможно, имеет смысл опубликовать это в нашем (своем) блоге, что бы была возможность сослаться на эту запись в будущих документах.

### "Что произошло?"

Здесь вы рассказываете историю инциндента. Все что произошло, включая временные метки событий, должны быть здесь. Это включает вещи, что случились без нашего ведома (например, увеличение трафика, о котором мы не знали), срабатывание оповещений, действия, которые мы предпринимали, что бы исправить проблему (смягчить последствия). Для долговременных инциндентов, хронология может быть достаточно длинной. Тогда имеет смысл перенести хронологию в отдельную секцию, что бы люди могли ссылаться на нее, если захотят более подробной информации, не загромождая раздел "Что произошло".

То ценное, что можно добавить в этот раздел - это конкретная (специфическая) информация, которая была у нас, когда мы выполняли какие-то действия. Одно дело сказать, что мы добавили больше емкости в кластер (и не добавить ничего к этому), но другое дело сказать, что мы увидели увеличение нагрузки и задержки в кластере Х и интерпретировали это как проблему в емкости, и решили увеличить емкость кластера. Если впоследствии это предположение окажется неверным - будет понятно, почему мы неправильно решили, почему предприняли конкретное действие и сможем позабоится о том, что бы в следующий раз получить более точную информацию о статусе инциндента.

### "Что прошло хорошо (получилось сделать)?"

Не все так плохо (Я имел ввиду, я так думаю... по крайней мере это то, что люди говорят мне!). Даже в случае [худшего инциндента](https://www.hostedgraphite.com/blog/spooky-action-at-a-distance-how-an-aws-outage-ate-our-load-balancer) некоторые вещи пройдут хорошо. Может быть [наш мониторинг](https://www.hostedgraphite.com/) очень быстро среагировал и предупредил нас, как раз вовремя, что бы предотвратить дальнейшие проблемы. Может наш балансировщик увел маршруты от затронутых узлов, увеличив задержку к сервисам, не допустив потерю данных.

Для большинства сервисов есть факторы, которые смягчили ситуацию, не позволив стать ситуации гораздо хуже. Важно понять, что это за факторы, и так как они могут помочь улучшить наше понимание, как сделать так, что бы система работала лучше, чем искать факторы, которые позволили системе стать уязвимой.

### "Что прошло плохо (не получилось сделать)?"

Здесь будут вещи, о которых мы не рады будем рассказывать: как случилось так, что произошел инциндент, или где наши утилиты/сервисы подвели нас. Это хорошее место, что бы показать, что мы могли бы сделать лучше. Здесь будет заключаться хороший стимул для определения необходимых задач, для улучшений в будущем.

Здесь также будут факторы, которые поспособствовали тому, что этот инциндент стал хуже, чем ожидалось сначала. Мы хотим понять эти факторы, и не просто их исправить, но и улучшить свое понимание, как работает наша система и что делает ее менее устойчивой.

### "Что мы будем делать в будущем?"

## Вещи, которые нужно держать в уме

Стиль наших postmortem должен совпадать по стилю Statuspage и другими средствами коммуникации с пользователями (в конце концов, они пишутся одной и той же командой для одних и тех же пользователей).

*Перевод еще не закончен*

На этом все.

### Дополнительные ссылки

1. ["It's dead, Jim": How we write an incident postmortem](https://www.hostedgraphite.com/blog/its-dead-jim-how-we-write-an-incident-postmortem)
2. [Hosted Graphite](https://www.hostedgraphite.com/)
3. [Chapter 15 of the SRE book](https://landing.google.com/sre/book/chapters/postmortem-culture.html)
4. ["The infinite hows" - John Allspaw](https://www.oreilly.com/ideas/the-infinite-hows)
5. [Incidents as we Imagine Them Versus How They Actually Are - John Allspaw (video)](https://www.youtube.com/watch?v=8DtzmV1jiyQ)
6. [How complex systems fail - Richard Cook](http://web.mit.edu/2.75/resources/random/How%20Complex%20Systems%20Fail.pdf)
7. [The Multiple Audiences and Purposes of Post-Incident Reviews](https://www.adaptivecapacitylabs.com/blog/2018/10/08/the-multiple-audiences-and-purposes-of-post-incident-reviews/)
8. [Some Observations On the Messy Realities of Incident Reviews](https://www.adaptivecapacitylabs.com/blog/2019/06/17/some-observations-on-the-messy-realities-of-incident-reviews/)
9. [Hindsight and sacrifice decisions](https://www.adaptivecapacitylabs.com/blog/2019/03/03/hindsight-and-sacrifice-decisions/)
